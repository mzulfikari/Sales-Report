{% extends "dashbord/manager/base.html" %}
{% block title %}سروریس جدید{% endblock title %}
{% load static %}
{% load jalali_tags %}
{% block content %}

<style>
    .form-inline-row {
        display: flex;
        align-items: center;
        gap: 1rem;
        direction: rtl;
        flex-wrap: wrap;
    }

    .form-inline-row label {
        flex: 0 0 130px;
        text-align: right;
        font-weight: 800;
        font-size: 0.95rem;
        margin: 0;
        color: #000;
    }

    .form-inline-row input {
        flex: 1;
        min-width: 180px;
        max-width: 100%;
        padding: 0.4rem 0.6rem;
        font-size: 0.95rem;
    }

    .plaque-group {
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 0.5rem;
        direction: ltr;
        flex-wrap: wrap;
    }

    .plaque-label {
        flex: 0 0 130px;
        font-weight: 800;
        font-size: 0.95rem;
        color: #000000c7;
        margin: 0;
        text-align: right;
    }

    .plaque-inputs input {
        flex: 0 0 auto;
        width: auto;
        min-width: 50px;
        max-width: 80px;
        text-align: center;
        font-weight: bold;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        letter-spacing: 2px;
        padding: 0.4rem 0.6rem;
    }

    .plaque-inputs input:nth-child(1),
    .plaque-inputs input:nth-child(4) {
        width: 60px;
    }

    .plaque-inputs input:nth-child(2) {
        width: 50px;
    }

    .plaque-inputs input:nth-child(3) {
        width: 80px;
    }

    .plaque-inputs {
        display: flex;
        flex-wrap: nowrap;
        gap: 0.5rem;
        direction: ltr;
        overflow-x: auto;
        padding-bottom: 0.5rem;
    }

    @media (max-width: 576px) {
        .plaque-group {
            flex-wrap: wrap;
            justify-content: flex-start;
        }

        .plaque-input {
            width: 60px !important;
            margin-bottom: 0.5rem;
        }
    }

    .upload-wrapper {
        display: flex;
        align-items: center;
        gap: 1rem;
        direction: rtl;
    }

    .upload-input {
        display: none;
    }

    .upload-label {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        cursor: pointer;
        background-color: #f0f0f0;
        padding: 0.6rem 1rem;
        border-radius: 8px;
        transition: background-color 0.3s ease;
        color: #333;
    }

    .upload-label:hover {
        background-color: #e0e0e0;
    }

    .upload-text {
        font-weight: bold;
        font-size: 0.95rem;
    }

    .upload-filename {
        border: 1px solid #ccc;
        border-radius: 6px;
        padding: 0.5rem 0.8rem;
        font-size: 0.9rem;
        background-color: #fff;
        width: 200px;
    }
</style>

<!-- BEGIN CSS -->
<link href="{% static 'css\inputcar.css' %}" rel="stylesheet">
<!-- BEGIN PAGE CONTENT -->
<div id="page-content">
    <div id="inner-content">
        <div class="row">
            <!-- BEGIN BREADCRUMB -->
            <div class="col-md-12">
                <div class="breadcrumb-box shadow">
                    <ul class="breadcrumb">
                        <li><a href="dashboard.html">پیشخوان</a></li>
                        <li><a href="#">فرم ها</a></li>
                        <li class="active">فرم ها</li>
                    </ul>
                    <div class="breadcrumb-left" style="font-weight: bold;">

                        {% jalali_now "%Y-%m-%d" %}

                        <i class="icon-calendar"></i>
                    </div><!-- /.breadcrumb-left -->
                </div><!-- /.breadcrumb-box -->
            </div><!-- /.col-md-12 -->
            <!-- END BREADCRUMB -->

            <div class="col-lg-6">
                <div class="portlet box shadow">
                    <div class="portlet-heading">
                        <div class="portlet-title">
                            <h3 class="title">
                                <i class="icon-settings"></i>
                                مشخصات خودرو
                            </h3>
                        </div>
                        <!-- /.portlet-title -->
                    </div>
                    <!-- /.portlet-heading -->
                    <div class="portlet-body">
                        <form role="form" method="post">
                            {% csrf_token %}
                            <div class="form-body">
                                <div class="form-group">
                                    <div class="form-inline-group">
                                        <div class="mb-4">
                                            <label for="{{ form.customer_phone.id_for_label }}" class="inline-label">
                                                {{ form.customer_phone.label }}
                                            </label>
                                        </div>
                                        {{ form.customer_phone }}
                                    </div>
                                    <!-- /.form-group -->
                                    <div class="form-inline-group">
                                        <div class="mb-4">
                                            <label for="{{ form.car.id_for_label }}" class="inline-label">
                                                {{ form.car.label }}
                                            </label>
                                        </div>
                                        {{form.car}}
                                        {% if form.car.errors %}
                                        <div class="flex items-center gap-2 text-red-600 text-sm mt-1">
                                            <i class="bi bi-exclamation-circle-fill"></i>
                                            <ul class="list-none m-0 p-0">
                                                {% for error in form.car.errors %}
                                                <li>{{ error }}</li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                        {% endif %}
                                    </div>

                                    <!-- /.form-group -->
                                    <div class="plaque-group mb-4" style="direction: rtl;">
                                        <label for="{{ form.plaque.id_for_label }}" class="plaque-label">
                                            {{ form.plaque.label }}
                                        </label>
                                        <div class="plaque-inputs" dir="ltr">

                                            {% for widget in form.plaque %}
                                            {{ widget }}
                                            {% endfor %}
                                        </div>
                                    </div>

                                    {% if form.plaque.errors %}
                                    <div class="flex items-center gap-2 text-red-600 text-sm mt-1">
                                        <i class="bi bi-exclamation-circle-fill"></i>
                                        <ul class="list-none m-0 p-0">
                                            {% for error in form.plaque.errors %}
                                            <li>{{ error }}</li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                    {% endif %}

                                    <!-- /.form-group -->
                                    <div class="form-inline-group">
                                        <div class="mb-4">
                                            <label for="{{ form.car_model.id_for_label }}" class="inline-label">
                                                {{ form.car_model.label }}
                                            </label>
                                        </div>
                                        {{form.car_model}}
                                        {% if form.car_model.errors %}
                                        <div class="flex items-center gap-2 text-red-600 text-sm mt-1">
                                            <i class="bi bi-exclamation-circle-fill"></i>
                                            <ul class="list-none m-0 p-0">
                                                {% for error in form.car_model.errors %}
                                                <li>{{ error }}</li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                        {% endif %}
                                    </div>
                                </div>

                                <!-- /.form-group -->
                                <div class="form-inline-group">
                                    <div class="mb-4">
                                        <label for="{{ form.current_kml.id_for_label }}" class="inline-label">
                                            {{ form.current_km.label }}
                                        </label>
                                    </div>
                                    {{form.current_km}}
                                    {% if form.current_km.errors %}
                                    <ul class="text-red-600 text-sm mt-1 list-none p-0">
                                        {% for error in form.current_km.errors %}
                                        <li>{{ error }}</li>
                                        {% endfor %}
                                    </ul>
                                    {% endif %}
                                </div>
                            </div>

                            <!-- /.form-group -->
                            <div class="form-inline-row mb-3">
                                <label for="{{ form.color.id_for_label }}">
                                    {{ form.color.label }}
                                </label>

                                <select id="{{ form.color.id_for_label }}" name="color"
                                    class="form-select form-select-sm w-auto">
                                    {% for value, label in form.fields.color.choices %}
                                    <option value="{{ value }}" {% if form.color.value == value %}selected{% endif %}>
                                        {{ label }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="upload-row" style="display: flex; gap: 1.5rem; align-items: center;">
  <!-- لیبل اصلی -->
  <label style="font-weight: bold; font-size: 15px; color: #333;">آپلود تصویر:</label>

  <!-- آپلود تصویر پلاک -->
  <div class="upload-wrapper" style="position: relative;">
    <input type="file" id="file-upload" class="upload-input" onchange="updateFileName(this)">
    <label for="file-upload" class="upload-label" style="cursor: pointer; display: flex; align-items: center; gap: 0.5rem;">
      <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
        <path d="M12 16v-8m0 0l-4 4m4-4l4 4M4 20h16a2 2 0 002-2V8a2 2 0 00-2-2h-4l-2-2h-4l-2 2H4a2 2 0 00-2 2v10a2 2 0 002 2z"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="upload-text">تصویر پلاک</span>
    </label>
  </div>

  <!-- آپلود تصویر کیلومتر -->
  <div class="upload-wrapper" style="position: relative;">
    <input type="file" id="km-upload" class="upload-input" onchange="updateFileName(this)">
    <label for="km-upload" class="upload-label" style="cursor: pointer; display: flex; align-items: center; gap: 0.5rem;">
      <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
        <path d="M12 6v6l4 2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="upload-text">تصویر کیلومتر</span>
    </label>
  </div>
</div>


                
                <!-- /.form-body -->
                <div class="d-flex justify-content-center mt-4">
                    <button type="submit" class="btn btn-success btn-round btn-lg px-5">
                        <i class="icon-check"></i>
                        ادامه
                    </button>
                </div>
                <!-- /.form-actions -->
            </div>
            <!-- /.portlet-body -->
        </div>
        </form>
        <!-- /.portlet -->

        <script>
            document.addEventListener("DOMContentLoaded", function() {
                const inputs = document.querySelectorAll(".plaque-input");
                inputs.forEach((input, index) => {
                    input.addEventListener("input", function() {
                        const maxLength = input.getAttribute("maxlength");
                        if (input.value.length >= maxLength) {
                            const nextInput = inputs[index + 1];
                            if (nextInput) {
                                nextInput.focus();
                            }
                        }
                    });
                    input.addEventListener("keydown", function(e) {
                        if (e.key === "Backspace" && input.value.length === 0) {
                            const prevInput = inputs[index - 1];
                            if (prevInput) {
                                prevInput.focus();
                            }
                        }
                    });
                });
            });
        </script>

        {% endblock %}